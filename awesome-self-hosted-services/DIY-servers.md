# 小小 IDC DIY

由于海鲜市场里，AMD  epyc 7d12, 7542,  Intel E5 2690 v4 CPU 过于香， 围绕它 DIY 服务器 是很有看头的。

上述三款 CPU 的特点如下：

1. epyc 7d12: 超级便宜 600CNY ；低功耗 85W;  32 核 64 线程。 适合做 NAS 等服务。
2. epyc 7542: 超级便宜 2600CNy；单核基准频率 2.9Ghz (7nm 制程); 32 核 64 线程。适合多开虚拟机 做云电脑服务器。
3. intel E5 2690v4：超级便宜 280CNY；基准频率 2.6 Ghz(E5系列最高频率的CPU了，14nm 制程); 14 核心 28 线程；适合做个小服务器, 远程开发机。

配上 二手 机箱、内存，硬盘，一手电源、主板 等，价格十分平民

此外 GPU 根据最近了解可简单分为几个等级：

1. 亮机卡 需求：100以内
2. 高码高清高分辨率 视频流的渲染 需求：300
3. 游戏/渲染 需求：2k ~, 上不封顶
4. 深度学习训练模型：4k ~, 上不封顶

接着下文从 最便宜的 CPU E5 2690 v4 开始练手实践.

## 搭建远程个人云电脑/开发机

截至 2023年，近乎10年前开始发布的系列 CPU 里面，应该选择代数尽量高，单核性能最高的，有两个原因：

1. [**代数越高**，制程越先进，**能耗比越高**](https://www.zhihu.com/question/270433294)；
2. [单核性能越高，越适合于胜任个人 PC 用途](https://www.zhihu.com/question/48275271)，且核多，跑并行任务也可。
3. 核心数 8个起。

根据该原则，很容易定位到想要的 CPU, 例如 e5 2667 v4 3.2Ghz 8 核心, 例如[百度贴吧里某位网友推崇](https://tieba.baidu.com/p/8422610723)的 E5 2690 v4 2.6 Ghz 12核心，再看看 CPU 利用率常年徘徊于 20% 左右，GPU 是 0， 就是好说我的电脑有至少 2/3 的成本在吃灰，因此同系统多账户或者多开虚拟机，远程共享硬件资源是个更低成本的解决方案。

由 该 CPU 的配置可延伸出其使用场景：个人 远程云电脑；远程开发机；家庭私服中心；媒体播放器。

根据 [瓜皮 Up 主 的视频](https://www.bilibili.com/video/BV1sv4y1c7VG)以及 淘宝店家客服的 指导列出如下硬件采购清单。

| 组件   | 价格        | 品牌及其型号                 | 参数                                                |      |
| ------ | ----------- | ---------------------------- | --------------------------------------------------- | ---- |
| 主板   | 330         | 华南 x99 qd4                 | 单路；<br />尺寸：245*190MMM-ATX板型                |      |
| CPU    | 275         | Intel E5 2960 v4             |                                                     |      |
| GPU    | 345         | 二手 七彩虹 GTX 1050 2G      |                                                     |      |
| 内存   | 3*90 = 270  | 三星 DDR4 2133 16G * 3       |                                                     |      |
| 硬盘   | 279+300=579 | 致钛 512G  固态 + WD 4T 黑盘 | 固态 2.5 寸, 寿命100%<br />英特尔 3.5 寸，寿命 100% |      |
| 散热器 | 99          | 利民 AX120 2010 定制版       | 长125mm * 宽 71mm * 高 158mm                        |      |
| 电源   | 249         | 长城 6000DS直出线 500W       | 尺寸：150mm * 140mm * 86mm                          |      |
| 机箱   | 100         | 傻瓜超人 手提式 K99 air      |                                                     |      |
|        |             |                              |                                                     |      |
| 总价   | 2228        |                              |                                                     |      |

小身板可以的。 不过只有 内存 和 硬盘能够复用，其余都不行

软件平台待续  ... 

## 以双路 epyc 7542 为 CPU 的 多人云电脑 Hub / 工作站

epyc 7542 单核主频 2.9Ghz 用作云电脑，非常不错，可以看到有[天翼云电脑的业界案例](https://www.cnii.com.cn/rmydb/202202/t20220228_360762.html)，自己搭建也没问题。

场景不单纯用作云电脑服务器，还可以进一步升级 GPU, 变为 深度学习服务器、远程游戏服务器 和 高性能工作站，同时承担 24 小时 online 的服务也不在话下。成本虽然突破万元，但是有8个人用四五年也足够便宜。

场景：

1. 云电脑。
2. 工作站。

缺点：

1. SOP 单点故障，要是多个用户正在使用该电脑处理重要事情，假如出问题了咋解决。内部玩、工作室内部能及时处理可以，但是要是比较分散感觉还是不一定行得通。解决方法是：双路 epyc7542 + 独立 NAS + 独立高性能游戏机(或者可以直接采用 13899K)。NAS 存储数据(同时备份副本到 115, 阿里, Onedrive 等多个网盘)，游戏机同时作为游戏机。其实设备可以是二手的，做好 故障转移和备份就行。
   1. 内存的故障转移技术了解一下：对于内存条的故障，一种可能的解决方案是使用支持ECC（Error Checking and Correction）的内存和主板。ECC内存可以自动检测并修复内存中的错误，从而提高系统的稳定性和可靠性。然而，ECC内存通常比普通内存更贵，而且需要主板的支持

[参考 B 站 瓜皮up主的硬件组合](https://www.bilibili.com/video/BV1vH4y1D7ow/)，暂时仅列出大头项目

| 组件 | 品牌及其型号                   | 价格              | 参数           |      |
| ---- | ------------------------------ | ----------------- | -------------- | ---- |
| 主板 | 超微 h11ssl                    | 2200              |                |      |
| CPU  | Epyc 7542 * 2                  | 5300              | 单核性能2.9Ghz |      |
| GPU  | Rtx 1080 Ti 8G /Rtx 3090Ti 24G | 2000 ~ 8000 ~ 1W+ |                |      |
| 内存 | 三星 DDR4 2133 16G * 8         | 720               |                |      |
| 硬盘 | 4 * 800G Intel SSD + 4 * 2T    | 1680              |                |      |
| 其余 |                                | 1000              |                |      |
|      |                                |                   |                |      |
|      |                                |                   |                |      |
| 总价 |                                | 12900 ~ 2W        |                |      |

### 围绕 epyc 7d12 低功耗 多核 CPU 搭建的 NAS 

待续

## 个人远程游戏主机

[论坛有人提到](https://www.chiphell.com/forum.php?mod=viewthread&tid=2535965&highlight=%E6%B8%B8%E6%88%8F&mobile=no)，epyc CPU 并不适合打游戏，所以想玩游戏，有几种方案：自己重新搭台桌面消费级主机而非服务器；去网吧；找台二手主机/外星人。如果是 12900K+主板+显卡的话，估计得 8000以上，CPU 2500, 硬盘+内存 1000，主板 2000+ 显卡2000+，其他1000

> 因为EPYC的外围设备多（支持128条PCI-E），CPU内部PCI-E控制器和内存控制器之间交换数据会比较复杂。
>
> 显卡运行效率大幅降低，游戏性能会受很大拖累，导致还不如普通桌面CPU

